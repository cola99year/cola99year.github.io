<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringBoot 2.5.0 | 可贺博客</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/logo.png">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3129839_xft6cqs5gc.css">
    <noscript><meta http-equiv="refresh" content="0; url=https://www.youngkbt.cn/noscript/"><style>.theme-vdoing-content { display:none }</noscript>
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.3baa4a3a.css" as="style"><link rel="preload" href="/assets/js/app.fb35259d.js" as="script"><link rel="preload" href="/assets/js/2.585c5b95.js" as="script"><link rel="preload" href="/assets/js/22.4f91168d.js" as="script"><link rel="prefetch" href="/assets/js/10.27a40fff.js"><link rel="prefetch" href="/assets/js/11.7e80cd60.js"><link rel="prefetch" href="/assets/js/12.247da339.js"><link rel="prefetch" href="/assets/js/13.4fbda935.js"><link rel="prefetch" href="/assets/js/14.5c505e7c.js"><link rel="prefetch" href="/assets/js/15.e31598c2.js"><link rel="prefetch" href="/assets/js/16.0b6b7b01.js"><link rel="prefetch" href="/assets/js/17.e9a1f43b.js"><link rel="prefetch" href="/assets/js/18.8ef84388.js"><link rel="prefetch" href="/assets/js/19.dbdc0d53.js"><link rel="prefetch" href="/assets/js/20.c4f07fc1.js"><link rel="prefetch" href="/assets/js/21.5d6f6d74.js"><link rel="prefetch" href="/assets/js/23.d360c8bb.js"><link rel="prefetch" href="/assets/js/24.fa85c993.js"><link rel="prefetch" href="/assets/js/25.74511e43.js"><link rel="prefetch" href="/assets/js/26.3ed9402e.js"><link rel="prefetch" href="/assets/js/27.b3d424ba.js"><link rel="prefetch" href="/assets/js/28.6593667e.js"><link rel="prefetch" href="/assets/js/29.bcdde230.js"><link rel="prefetch" href="/assets/js/3.f2d082d5.js"><link rel="prefetch" href="/assets/js/30.e50ddda6.js"><link rel="prefetch" href="/assets/js/31.5ff94da6.js"><link rel="prefetch" href="/assets/js/32.de603b74.js"><link rel="prefetch" href="/assets/js/33.fe792d39.js"><link rel="prefetch" href="/assets/js/34.8205ce8a.js"><link rel="prefetch" href="/assets/js/4.4e340746.js"><link rel="prefetch" href="/assets/js/5.8a4cd9ed.js"><link rel="prefetch" href="/assets/js/6.bc6bf19a.js"><link rel="prefetch" href="/assets/js/7.564f80d1.js"><link rel="prefetch" href="/assets/js/8.dddf85dc.js"><link rel="prefetch" href="/assets/js/9.37d5963e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3baa4a3a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">可贺博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/笔记汇总/入口文件.html" class="nav-link">目录导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发必备" class="dropdown-title"><!----> <span class="title" style="display:;">开发必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/笔记汇总/60.开发必备/10.Nginx.html" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/笔记汇总/60.开发必备/20.腾讯云.html" class="nav-link">腾讯云</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人日记" class="dropdown-title"><!----> <span class="title" style="display:;">个人日记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/笔记汇总/109.个人日记/03.工作随手记.html" class="nav-link">工作日记</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/cola99year" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/笔记汇总/入口文件.html" class="nav-link">目录导航</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发必备" class="dropdown-title"><!----> <span class="title" style="display:;">开发必备</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/笔记汇总/60.开发必备/10.Nginx.html" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/笔记汇总/60.开发必备/20.腾讯云.html" class="nav-link">腾讯云</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人日记" class="dropdown-title"><!----> <span class="title" style="display:;">个人日记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/笔记汇总/109.个人日记/03.工作随手记.html" class="nav-link">工作日记</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/cola99year" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaSE</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Spring框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>SpringBoot2.5</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/a42eba/" class="sidebar-link">测试</a></li></ul></section></li><li><a href="/pages/186adc/" aria-current="page" class="active sidebar-link">SpringBoot 2.5.0</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_0-1-清理maven仓库" class="sidebar-link">0.1 清理Maven仓库</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_0-2-更改启动图标" class="sidebar-link">0.2 更改启动图标</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_0-3-热部署" class="sidebar-link">0.3 热部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-准备工作" class="sidebar-link">1 准备工作</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2-使用" class="sidebar-link">2. 使用</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_1-1-pom-xml" class="sidebar-link">1.1 pom.xml</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_1-2-依赖文件相关知识" class="sidebar-link">1.2 依赖文件相关知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-maven-helper插件" class="sidebar-link">1. Maven Helper插件</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#主启动类-springbootapplication" class="sidebar-link">主启动类@SpringBootApplication</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#componentscan" class="sidebar-link">@ComponentScan</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_3-1-配置参考大全" class="sidebar-link">3.1 配置参考大全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#application-properties" class="sidebar-link">application.properties</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#application-yml" class="sidebar-link">application.yml</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_3-2-配置文件的语法" class="sidebar-link">3.2 配置文件的语法</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_3-3-springboot读取yml" class="sidebar-link">3.3 SpringBoot读取yml</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#value注解读取" class="sidebar-link">@Value注解读取</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#configurationproperties读取" class="sidebar-link">@ConfigurationProperties读取</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_3-4-多个配置文件" class="sidebar-link">3.4 多个配置文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-配置文件的多种环境" class="sidebar-link">1. 配置文件的多种环境</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2-配置文件的优先级" class="sidebar-link">2. 配置文件的优先级</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_4-1-使用" class="sidebar-link">4.1 使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1添加依赖" class="sidebar-link">①添加依赖</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2编写测试类" class="sidebar-link">②编写测试类</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_4-2-解决包不一致问题" class="sidebar-link">4.2 解决包不一致问题</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_4-3-兼容老版本" class="sidebar-link">4.3 兼容老版本</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-新老版本问题" class="sidebar-link">1. 新老版本问题</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2-解决老版本依赖" class="sidebar-link">2. 解决老版本依赖</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_5-1-跨域请求概念" class="sidebar-link">5.1 跨域请求概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-什么是跨域" class="sidebar-link">1. 什么是跨域</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2-cors如何解决跨域的" class="sidebar-link">2. CORS如何解决跨域的？</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_5-2-springboot使用cors解决跨域" class="sidebar-link">5.2 SpringBoot使用CORS解决跨域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-使用-crossorigin注解" class="sidebar-link">1. 使用@CrossOrigin注解</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2-跨域配置类" class="sidebar-link">2. 跨域配置类</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_6-1-拦截器intercepter" class="sidebar-link">6.1 拦截器Intercepter</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_6-2-统一异常处理" class="sidebar-link">6.2 统一异常处理</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_6-3-自定义参数解析" class="sidebar-link">6.3 自定义参数解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-在resolver包下" class="sidebar-link">1. 在resolver包下</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2-config包下" class="sidebar-link">2. config包下</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_3-测试" class="sidebar-link">3. 测试</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_6-4-声明式事务" class="sidebar-link">6.4 声明式事务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#使用介绍" class="sidebar-link">使用介绍</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#失效的场景" class="sidebar-link">失效的场景</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_6-5-aop入门" class="sidebar-link">6.5 AOP入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#proceedingjoinpoint用法使用详解" class="sidebar-link">ProceedingJoinPoint用法使用详解</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_1-准备环境" class="sidebar-link">1. 准备环境</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_2-使用测试" class="sidebar-link">2. 使用测试</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_3-切换为jdk动态代理" class="sidebar-link">3. 切换为jdk动态代理</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_6-6-博客项使用aop" class="sidebar-link">6.6 博客项使用Aop</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#自定义注解-在annotation包下" class="sidebar-link">自定义注解，在annotation包下</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#切面-在aspect包下" class="sidebar-link">切面，在aspect包下</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#使用注解" class="sidebar-link">使用注解</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#_6-7-日志" class="sidebar-link">6.7 日志</a></li><li class="sidebar-sub-header level2"><a href="/pages/186adc/#jsr303数据校验-validated" class="sidebar-link">JSR303数据校验@validated</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_5-1-数据校验例子" class="sidebar-link">5.1 数据校验例子</a></li><li class="sidebar-sub-header level3"><a href="/pages/186adc/#_5-2-数据校验大全" class="sidebar-link">5.2 数据校验大全</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发必备</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>搞机工具箱</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>个人日记</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E7%AC%94%E8%AE%B0%E6%B1%87%E6%80%BB" title="分类" data-v-06225672>笔记汇总</a></li><li data-v-06225672><a href="/categories/?category=Spring%E6%A1%86%E6%9E%B6" title="分类" data-v-06225672>Spring框架</a></li></ul> <div class="info" data-v-06225672><!----> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-03-28</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">SpringBoot 2.5.0<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>参考资料</p> <p><a href="https://blog.csdn.net/jsdoulaoula/article/details/124717458?ops_request_misc=%7B%22request%5Fid%22%3A%22166011523616782248529753%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=166011523616782248529753&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-124717458-null-null.142%5Ev40%5Epc_rank_34_2,185%5Ev2%5Econtrol&amp;utm_term=%E4%B8%89%E6%9B%B4Springboot&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener noreferrer">SpringBoot-基础入门-三更草堂补充版<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>；</p> <p>Spring的阿里源镜像：<strong>https://start.aliyun.com/</strong></p> <h1 id="_0-题外小知识"><a href="#_0-题外小知识" class="header-anchor">#</a> 0. 题外小知识</h1> <h2 id="_0-1-清理maven仓库"><a href="#_0-1-清理maven仓库" class="header-anchor">#</a> 0.1 清理Maven仓库</h2> <p>由于网络波动问题导致jar下载不全的问题jar包，复制为bat文件双击运行，<strong>C盘的仓库需要右键管理员运行</strong></p> <div class="language-txt extra-class"><pre class="language-txt"><code>@echo off
rem create by NettQun
  
rem 这里写你的仓库路径
set REPOSITORY_PATH=D:\colaStudy\Environment\apache-maven-3.8.3\maven-repo
rem 正在搜索...
for /f &quot;delims=&quot; %%i in ('dir /b /s &quot;%REPOSITORY_PATH%\*lastUpdated*&quot;') do (
    echo %%i
    del /s /q &quot;%%i&quot;
)
rem 搜索完毕
pause

</code></pre></div><h2 id="_0-2-更改启动图标"><a href="#_0-2-更改启动图标" class="header-anchor">#</a> 0.2 更改启动图标</h2> <p>内容可以随便百度搜Springboot的banner</p> <p><img src="https://img-blog.csdnimg.cn/8f0c7583cf0149a4b99a2015f098ffa5.png" alt="img"></p> <hr> <h2 id="_0-3-热部署"><a href="#_0-3-热部署" class="header-anchor">#</a> 0.3 热部署</h2> <p>​	SpringBoot为我们提供了一个方便我们开发测试的工具dev-tools。使用后可以实现热部署的效果。当我们运行了程序后对程序进行了修改，程序会自动重启。</p> <p>​	 原理是使用了两个ClassLoder，一个ClassLoader加载哪些不会改变的类(第三方jar包)，另一个ClassLoader加载会更改的类。称之为Restart ClassLoader，这样在有代码更改的时候，原来的Restart Classloader被丢弃，重新创建一个Restart ClassLoader，由于需要加载的类相比较少，所以实现了较快的重启。</p> <p>​</p> <h3 id="_1-准备工作"><a href="#_1-准备工作" class="header-anchor">#</a> 1 准备工作</h3> <p>①设置IDEA自动编译</p> <p>​	 在idea中的setting做下面配置</p> <img src="https://i0.hdslb.com/bfs/album/7a72a1247f7427ed628635342a5888fa2218bb6c.png" alt="image-20220810233856598" style="zoom:50%;"> <hr> <img src="https://i0.hdslb.com/bfs/album/7c21cd1c7599f211b6888dd99340ce1e75b33a0a.png" alt="image-20220810233910367" style="zoom:67%;"> <h3 id="_2-使用"><a href="#_2-使用" class="header-anchor">#</a> 2. 使用</h3> <p>①添加依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>②触发热部署</p> <p>​	当我们在修改完代码或者静态资源后可以切换到其它软件，让IDEA自动进行编译，自动编译后就会触发热部署。</p> <p>​	或者使用Ctrl+F9手动触发重新编译。</p> <h1 id="_1-pom-xml"><a href="#_1-pom-xml" class="header-anchor">#</a> 1. pom.xml</h1> <blockquote><ul><li>我们导入依赖默认是不需要写版本，版本都在父依赖中，父依赖上又有父依赖</li> <li>如果导入的包，没有在父依赖中，就需要手动配置版本</li> <li>SpringBoot将所有功能场景都做成一个个的starter （启动器），引入这些starter就是引入jar包，
<ul><li><strong>官方</strong>starter都是<strong>以 spring-boot-starter开头</strong>后面跟上场景名称。例如：spring-boot-starter-data-jpa</li> <li><strong>非官方</strong>starter则是以 场景名-spring-boot-starter的格式，例如：mybatis-spring-boot-starter，<strong>需要指定版本号！</strong></li></ul></li> <li>大牛可以自己写 starter；</li></ul></blockquote> <h2 id="_1-1-pom-xml"><a href="#_1-1-pom-xml" class="header-anchor">#</a> 1.1 pom.xml</h2> <div class="language-XML extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.cola<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--改：项目名称，如colablog等--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sgSpringBoot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.1-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--搞父工程，可防止依赖版本冲突--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.5.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--web依赖--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--热部署--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--单元测试Junit5--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--mysql驱动--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--        集成redis--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--mybatis启动器--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--mybatis-plus启动器--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.4.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--fastjson依赖--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.33<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--jwt依赖--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.jsonwebtoken<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jjwt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--springboot打jar包插件--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><h2 id="_1-2-依赖文件相关知识"><a href="#_1-2-依赖文件相关知识" class="header-anchor">#</a> 1.2 依赖文件相关知识</h2> <h3 id="_1-maven-helper插件"><a href="#_1-maven-helper插件" class="header-anchor">#</a> 1. Maven Helper插件</h3> <p>下载<strong>Maven Helper插件</strong>，可以排除掉低版本的依赖，留下高版本的依赖。</p> <p>插件使用在IDEA最下方，如图：</p> <img src="https://i0.hdslb.com/bfs/album/74b536040f1eaae4fea5c380e7626168a036aa76.png" alt="image-20220810162954027" style="zoom:67%;"> <h1 id="_2-常用注解分析"><a href="#_2-常用注解分析" class="header-anchor">#</a> 2. 常用注解分析</h1> <h3 id="主启动类-springbootapplication"><a href="#主启动类-springbootapplication" class="header-anchor">#</a> 主启动类@SpringBootApplication</h3> <p>@SpringBootApplication 来标注一个主程序类， SpringBoot就应运行这个类的main方法来启动SpringBoot应用；</p> <p><img src="/assets/img/0247a293d3c7e61a4283f3d3b9b98f5b.0669065b.jpg" alt=""></p> <h3 id="componentscan"><a href="#componentscan" class="header-anchor">#</a> @ComponentScan</h3> <p>这个注解在Spring中很重要，它对应XML配置中的元素。</p> <p>作用：自动扫描并加载符合条件的组件或者bean ， 将这个bean定义加载到IOC容器中</p> <h1 id="_3-配置文件"><a href="#_3-配置文件" class="header-anchor">#</a> 3. 配置文件</h1> <blockquote><p>是在resources的目录下</p></blockquote> <h2 id="_3-1-配置参考大全"><a href="#_3-1-配置参考大全" class="header-anchor">#</a> 3.1 配置参考大全</h2> <blockquote><p>我们可以使用一些网站非常方便的实现YML和properties格式配置的相互转换。</p> <p>转换网站：https://www.toyaml.com/index.html</p></blockquote> <h3 id="application-properties"><a href="#application-properties" class="header-anchor">#</a> application.properties</h3> <div class="language-properties extra-class"><pre class="language-properties"><code>
<span class="token comment"># 数据库驱动：</span>
<span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span>
<span class="token comment"># 数据库连接地址</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/colablog?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimeZone=UTC</span>
<span class="token comment"># 数据库用户名&amp;密码</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">123456</span>
<span class="token comment"># 应用服务 WEB 访问端口</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">8080</span>

<span class="token comment">#配置Redis</span>
<span class="token comment"># REDIS (RedisProperties)</span>
<span class="token comment"># Redis数据库索引（默认为0）</span>
<span class="token key attr-name">spring.redis.database</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>
<span class="token comment"># Redis服务器地址</span>
<span class="token key attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token value attr-value">120.25.249.93</span>
<span class="token comment"># Redis服务器连接端口</span>
<span class="token key attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token value attr-value">6379</span>
<span class="token comment"># Redis服务器连接密码（默认为空）</span>
<span class="token key attr-name">spring.redis.password</span><span class="token punctuation">=</span><span class="token value attr-value">Qq8981969..</span>
<span class="token comment"># 连接池最大连接数（使用负值表示没有限制）</span>
<span class="token key attr-name">spring.redis.pool.max-active</span><span class="token punctuation">=</span><span class="token value attr-value">8</span>
<span class="token comment"># 连接池最大阻塞等待时间（使用负值表示没有限制，也可1000，单位毫秒）</span>
<span class="token key attr-name">spring.redis.pool.max-wait</span><span class="token punctuation">=</span><span class="token value attr-value">-1</span>
<span class="token comment"># 连接池中的最大空闲连接</span>
<span class="token key attr-name">spring.redis.pool.max-idle</span><span class="token punctuation">=</span><span class="token value attr-value">8</span>
<span class="token comment"># 连接池中的最小空闲连接：最大空闲连接太久一直没人用也会清理的，因此设置最小空闲连接</span>
<span class="token key attr-name">spring.redis.pool.min-idle</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>
</code></pre></div><h3 id="application-yml"><a href="#application-yml" class="header-anchor">#</a> application.yml</h3> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/colablog<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;serverTimeZone=UTC</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 120.25.249.93 <span class="token comment">#指定redis所在的host</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> Qq8981969.. <span class="token comment">#设置redis密码</span>
    <span class="token key atrule">pool</span><span class="token punctuation">:</span>
      <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">8</span> <span class="token comment">#最大连接数</span>
      <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">8</span> <span class="token comment">#最大空闲数</span>
      <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">-1</span> <span class="token comment"># 连接池最大阻塞等待时间（使用负值表示没有限制，也可1000，单位毫秒）</span>
      <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token comment">#连接等待时间</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">6379</span>
</code></pre></div><h2 id="_3-2-配置文件的语法"><a href="#_3-2-配置文件的语法" class="header-anchor">#</a> 3.2 配置文件的语法</h2> <blockquote><p>概念：SpringBoot使用一个全局的配置文件 ， 配置文件<strong>名称是固定的</strong></p> <p>作用 ：用于修改SpringBoot自动配置的默认值，比如修改Tomcat 默认启动的端口号。因为SpringBoot在底层都给我们自动配置好了；</p></blockquote> <ol><li>application.properties：语法结构 ：key = value</li> <li>application.yml ：语法结构 ：key：空格 value</li></ol> <p>yml支持很多语法，功能比较强，yml语法演示如下：</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment">#对象多行写法</span>
<span class="token key atrule">student</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> cola
  <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">18</span>
  
<span class="token comment">#行内写法</span>
<span class="token key atrule">student</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token key atrule">name</span><span class="token punctuation">:</span> qinjiang<span class="token punctuation">,</span><span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>

<span class="token comment">#数组或list、set的多行写法</span>
<span class="token key atrule">pets</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> cat
  <span class="token punctuation">-</span> dog
  <span class="token punctuation">-</span> pig
  
<span class="token comment">#数组或list、set的行内写法</span>
<span class="token key atrule">pets</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>cat<span class="token punctuation">,</span>dog<span class="token punctuation">,</span>pig<span class="token punctuation">]</span>


<span class="token comment"># yaml文件还可以用El表达式，生成随即年龄</span>
<span class="token key atrule">person</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> cola
  <span class="token key atrule">age</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>random.int<span class="token punctuation">}</span>
</code></pre></div><h2 id="_3-3-springboot读取yml"><a href="#_3-3-springboot读取yml" class="header-anchor">#</a> 3.3 SpringBoot读取yml</h2> <h3 id="value注解读取"><a href="#value注解读取" class="header-anchor">#</a> @Value注解读取</h3> <blockquote><p>注意使用此注解只能获取简单类型的值（8种基本数据类型及其包装类，String,Date）</p></blockquote> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">student</span><span class="token punctuation">:</span>
  <span class="token key atrule">lastName</span><span class="token punctuation">:</span> sangeng
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${student.lastName}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>lastName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="configurationproperties读取"><a href="#configurationproperties读取" class="header-anchor">#</a> @ConfigurationProperties读取</h3> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">student01</span><span class="token punctuation">:</span>
  <span class="token key atrule">lastName</span><span class="token punctuation">:</span> sangeng
  <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">17</span>
<span class="token key atrule">student2</span><span class="token punctuation">:</span>
  <span class="token key atrule">lastName</span><span class="token punctuation">:</span> sangeng2
  <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">15</span>

</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@Component</span>
<span class="token comment">//即读取yml文件中前缀是student01开头的，你的get和set会自动读取并给这个类的属性赋值</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;student01&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">Student</span> student01<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">Student</span> student02<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/test&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//只输出student01的，也是容器单例模式的原因</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student01<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Student(lastName=sangeng, age=22)</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>student02<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Student(lastName=sangeng, age=22)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>如果使用了@ConfigurationProperties注解，可以增加以下依赖，让我们在<strong>书写配置时</strong>有相应的提示。即在yml配置文件有提示。</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_3-4-多个配置文件"><a href="#_3-4-多个配置文件" class="header-anchor">#</a> 3.4 多个配置文件</h2> <h3 id="_1-配置文件的多种环境"><a href="#_1-配置文件的多种环境" class="header-anchor">#</a> 1. 配置文件的多种环境</h3> <p>编写配置文件时候，可以指定多个环境版本：</p> <ul><li>application-test.properties 代表<strong>测试</strong>环境</li> <li>application-dev.properties 代表<strong>开发</strong>环境</li> <li>application-prod.properties 代表<strong>生产</strong>环境</li></ul> <p>但是Springboot并不会直接启动这些配置文件，它<strong>默认使用application.properties主配置文件</strong>，代码如下：</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment">#比如在配置文件中指定使用dev环境，我们可以通过设置不同的端口号进行测试；</span>
<span class="token comment">#我们启动SpringBoot，就可以看到已经切换到dev下的配置了；</span>

<span class="token key attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token value attr-value">dev</span>
</code></pre></div><p>profiles配置激活，active激活</p> <h3 id="_2-配置文件的优先级"><a href="#_2-配置文件的优先级" class="header-anchor">#</a> 2. 配置文件的优先级</h3> <blockquote><p>存放配置文件的路径有以下几个地方，并且还有加载的优先级！</p></blockquote> <p>springboot 启动会扫描以下位置的application.properties或者application.yml文件作为Spring boot的默认配置文件</p> <ul><li><strong>优先级1：项目路径下（整个项目下）的config文件夹配置文件</strong></li> <li><strong>优先级2：项目路径下配置文件</strong></li> <li><strong>优先级3：资源路径下（resources）的config文件夹配置文件</strong></li> <li><strong>优先级4：资源路径下（resources）配置文件</strong></li></ul> <p>优先级由高到底，高优先级的配置会覆盖低优先级的配置；</p> <h1 id="_4-单元测试"><a href="#_4-单元测试" class="header-anchor">#</a> 4. 单元测试</h1> <blockquote><p><strong>Spring Boot 2.2.0 版本开始引入 JUnit 5 作为单元测试默认库</strong>。Junit5功能相比于Junit4也会更强大。</p> <p>针对Junit5的新功能做介绍，需要去单独找视频学习。</p></blockquote> <h2 id="_4-1-使用"><a href="#_4-1-使用" class="header-anchor">#</a> 4.1 使用</h2> <h3 id="_1添加依赖"><a href="#_1添加依赖" class="header-anchor">#</a> ①添加依赖</h3> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="_2编写测试类"><a href="#_2编写测试类" class="header-anchor">#</a> ②编写测试类</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>cola<span class="token punctuation">.</span>sgspringboot</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ColaTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;cola&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_4-2-解决包不一致问题"><a href="#_4-2-解决包不一致问题" class="header-anchor">#</a> 4.2 解决包不一致问题</h2> <p><strong>注意</strong>：测试类所在的包需要和启动类是在同一个包下，如下图所示：</p> <img src="https://i0.hdslb.com/bfs/album/61d8ff5d592fc6d197ddc452ba9d7af4ca3702b5.png" alt="image-20220810235850333" style="zoom:67%;"> <p><strong>若不在同一个包下</strong>，则要使用如下写法指定<code>启动类</code>。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sangeng<span class="token punctuation">.</span>controller<span class="token punctuation">.</span></span><span class="token class-name">HelloController</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>jupiter<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>

<span class="token comment">//classes属性来指定启动类</span>
<span class="token annotation punctuation">@SpringBootTest</span><span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token class-name">HelloApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">HelloController</span> helloController<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testJunit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>helloController<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="_4-3-兼容老版本"><a href="#_4-3-兼容老版本" class="header-anchor">#</a> 4.3 兼容老版本</h2> <h3 id="_1-新老版本问题"><a href="#_1-新老版本问题" class="header-anchor">#</a> 1. 新老版本问题</h3> <p>​	如果是对老项目中的SpringBoot进行了版本升级，会发现之前的单元测试代码出现了一些问题。</p> <p>​	因为<strong>Junit5</strong>和之前的<strong>Junit4</strong>有比较大的不同。</p> <blockquote><p>从下图可以看出  <strong>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</strong></p></blockquote> <p><img src="https://i0.hdslb.com/bfs/album/61558b9776d19c273c784585b280b03b0caac037.png" alt="img"></p> <p>​</p> <ul><li><strong>JUnit Platform</strong>： 这是Junit提供的平台功能模块，通过它，其它的测试引擎也可以接入</li> <li><strong>JUnit JUpiter</strong>：这是JUnit5的核心，是一个基于JUnit Platform的引擎实现，它包含许多丰富的新特性来使得自动化测试更加方便和强大。</li> <li><strong>JUnit Vintage</strong>：这个模块是兼容JUnit3、JUnit4版本的测试引擎，使得旧版本的自动化测试也可以在JUnit5下正常运行。</li></ul> <p>​	虽然Junit5包含了<strong>JUnit Vintage</strong>来兼容JUnit3和Junit4，但是<strong>SpringBoot 2.4 以上版本对应的spring-boot-starter-test移除了默认对</strong> **Vintage 的依赖。**所以当我们仅仅依赖spring-boot-starter-test时会发现之前我们使用的@Test注解和@RunWith注解都不能使用了。</p> <h3 id="_2-解决老版本依赖"><a href="#_2-解决老版本依赖" class="header-anchor">#</a> 2. 解决老版本依赖</h3> <blockquote><p>我们使用新版本Springboot，若单元测试想兼容老版本，可以单独在依赖vintage来进行兼容。</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.junit.vintage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit-vintage-engine<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>这是老版本单元测试的写法</p></blockquote> <p>org.junit.Test对应的是Junit4的版本，就搭配**@RunWith注解**来使用。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sangeng<span class="token punctuation">.</span>controller<span class="token punctuation">.</span></span><span class="token class-name">HelloController</span></span><span class="token punctuation">;</span>
<span class="token comment">//import org.junit.jupiter.api.Test;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token comment">//classes属性来指定启动类</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">HelloController</span> helloController<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testJunit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>helloController<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="_5-cors-跨域"><a href="#_5-cors-跨域" class="header-anchor">#</a> 5. CORS 跨域</h1> <h2 id="_5-1-跨域请求概念"><a href="#_5-1-跨域请求概念" class="header-anchor">#</a> 5.1 跨域请求概念</h2> <h3 id="_1-什么是跨域"><a href="#_1-什么是跨域" class="header-anchor">#</a> 1. 什么是跨域</h3> <p>​	浏览器出于安全的考虑，使用 XMLHttpRequest对象发起 <strong>HTTP请求</strong>时必须遵守<strong>同源策略</strong>，否则就是跨域的HTTP请求，默认情况下是被禁止的。 同源策略要求源相同才能正常进行通信，即<strong>协议、域名、端口号</strong>都完全一致。</p> <h3 id="_2-cors如何解决跨域的"><a href="#_2-cors如何解决跨域的" class="header-anchor">#</a> 2. CORS如何解决跨域的？</h3> <p>​	CORS是一个<strong>W3C标准</strong>，全称是“跨域资源共享”（Cross-origin resource sharing），允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。</p> <p>​	它通过服务器增加一个特殊的响应头Header：[<code>Access-Control-Allow-Origin</code>]来告诉客户端跨域的限制，如果浏览器支持CORS、并且判断Origin通过的话，就会允许XMLHttpRequest发起跨域请求。现在的浏览器基本都支持CORS跨域了。</p> <p>​</p> <h2 id="_5-2-springboot使用cors解决跨域"><a href="#_5-2-springboot使用cors解决跨域" class="header-anchor">#</a> 5.2 SpringBoot使用CORS解决跨域</h2> <h3 id="_1-使用-crossorigin注解"><a href="#_1-使用-crossorigin注解" class="header-anchor">#</a> 1. 使用@CrossOrigin注解</h3> <p>在方法上或者是Controller类上，加上**@CrossOrigin注解**就支持跨域了。但是太麻烦~</p> <h3 id="_2-跨域配置类"><a href="#_2-跨域配置类" class="header-anchor">#</a> 2. 跨域配置类</h3> <p>原理：使用 <strong>WebMvcConfigurer</strong> 的 addCorsMappings 方法配置CorsInterceptor，我们实现接口重写其方法！</p> <ul><li><a href="">WebMvcConfigurer</a>：MVC提供的接口，用于解决MVC相关的问题</li> <li><a href="">CorsInterceptor</a>：MVC的拦截器</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCorsMappings</span><span class="token punctuation">(</span><span class="token class-name">CorsRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 设置允许跨域的路径</span>
        registry<span class="token punctuation">.</span><span class="token function">addMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置允许跨域请求的域名</span>
                <span class="token punctuation">.</span><span class="token function">allowedOriginPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// 是否允许cookie</span>
                <span class="token punctuation">.</span><span class="token function">allowCredentials</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置允许的请求方式</span>
                <span class="token punctuation">.</span><span class="token function">allowedMethods</span><span class="token punctuation">(</span><span class="token string">&quot;GET&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DELETE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PUT&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// 设置允许的header属性</span>
                <span class="token punctuation">.</span><span class="token function">allowedHeaders</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// 跨域允许时间</span>
                <span class="token punctuation">.</span><span class="token function">maxAge</span><span class="token punctuation">(</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="_6-springboot常见功能"><a href="#_6-springboot常见功能" class="header-anchor">#</a> 6. SpringBoot常见功能</h1> <h2 id="_6-1-拦截器intercepter"><a href="#_6-1-拦截器intercepter" class="header-anchor">#</a> 6.1 拦截器Intercepter</h2> <p>新建一个<strong>interceptor包下</strong>，编写登录拦截器类，用@Component注入到容器中</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取请求头中的token</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//判断token是否为空，如果为空也代表未登录 提醒重新登录（401）</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            response<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span><span class="token constant">SC_UNAUTHORIZED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//解析token看看是否成功</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token class-name">JwtUtil</span><span class="token punctuation">.</span><span class="token function">parseJWT</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> subject <span class="token operator">=</span> claims<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>subject<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//如果解析过程中没有出现异常说明是登录状态</span>
            <span class="token comment">//如果出现了异常，说明未登录，提醒重新登录（401）</span>
            response<span class="token punctuation">.</span><span class="token function">sendError</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">.</span><span class="token constant">SC_UNAUTHORIZED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>配置拦截器：LoginConfig</p> <blockquote><p>从容器中把楼上的登录拦截器拿出来，在重写WebMvcConfigurer接口的方法中添加拦截器</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token comment">//从容器中把拦截器拿出来</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">LoginInterceptor</span> loginInterceptor<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span>loginInterceptor<span class="token punctuation">)</span><span class="token comment">//添加拦截器</span>
            <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//配置拦截路径</span>
            <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/sys_user/login&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//配置排除路径</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_6-2-统一异常处理"><a href="#_6-2-统一异常处理" class="header-anchor">#</a> 6.2 统一异常处理</h2> <blockquote><p>先前在MVC讲过，现在实战运用。</p></blockquote> <p>在<strong>exception包下</strong>：定义统一异常处理类，使用**@ExceptionHandler**标识可以处理的异常。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyControllerAdvice</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">RuntimeException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">handlerException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//获取异常信息，存放如ResponseResult的msg属性</span>
        <span class="token class-name">String</span> message <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ResponseResult</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//把ResponseResult作为返回值返回，要求到时候转换成json存入响应体中</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>上面定义好，只要我们抛出对应的异常对象，就会被上面捕获到了！如下例子运用上面的捕获异常代码：</p></blockquote> <p>在我们一些写的代码中直接new出异常throw抛出！</p> <div class="language-java extra-class"><pre class="language-java"><code>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;未登录，请先登录！&quot;</span><span class="token punctuation">)</span> 
    <span class="token punctuation">}</span>
</code></pre></div><img src="https://i0.hdslb.com/bfs/album/f5a13021a087850c503bd26cd456871c4fecf410.png" alt="image-20220811150435525" style="zoom:67%;"> <h2 id="_6-3-自定义参数解析"><a href="#_6-3-自定义参数解析" class="header-anchor">#</a> 6.3 自定义参数解析</h2> <blockquote><p>如果每个接口都要重复去解析token拿到用户id，太麻烦了，我们可以去统一解析，只需要在参数上加个注解就可以了</p> <p>可以使用<strong>HandlerMethodArgumentResolver</strong>来实现自定义的参数解析。</p></blockquote> <h3 id="_1-在resolver包下"><a href="#_1-在resolver包下" class="header-anchor">#</a> 1. 在resolver包下</h3> <p>①定义用来标识的注解<strong>CurrentUserId</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//注解只可用在参数上</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">PARAMETER</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">CurrentUserId</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>②创建类实现HandlerMethodArgumentResolver接口并重写其中的方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserIdArgumentResolver</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerMethodArgumentResolver</span> <span class="token punctuation">{</span>

    <span class="token comment">//判断方法参数使用能使用当前的参数解析器进行解析</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supportsParameter</span><span class="token punctuation">(</span><span class="token class-name">MethodParameter</span> parameter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//如果方法参数有加上CurrentUserId注解，就能把被我们的解析器解析</span>
        <span class="token keyword">return</span> parameter<span class="token punctuation">.</span><span class="token function">hasParameterAnnotation</span><span class="token punctuation">(</span><span class="token class-name">CurrentUserId</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//进行参数解析的方法，可以在方法中获取对应的数据，然后把数据作为返回值返回。方法的返回值就会赋值给对应的方法参数</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">resolveArgument</span><span class="token punctuation">(</span><span class="token class-name">MethodParameter</span> parameter<span class="token punctuation">,</span> <span class="token class-name">ModelAndViewContainer</span> mavContainer<span class="token punctuation">,</span> <span class="token class-name">NativeWebRequest</span> webRequest<span class="token punctuation">,</span> <span class="token class-name">WebDataBinderFactory</span> binderFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取请求头中的token</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> webRequest<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//解析token，获取userId</span>
            <span class="token class-name">Claims</span> claims <span class="token operator">=</span> <span class="token class-name">JwtUtil</span><span class="token punctuation">.</span><span class="token function">parseJWT</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> userId <span class="token operator">=</span> claims<span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//返回结果</span>
            <span class="token keyword">return</span> userId<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-config包下"><a href="#_2-config包下" class="header-anchor">#</a> 2. config包下</h3> <p>配置参数解析器，又用到WebMvcConfigurer接口，把解析器添加到里边</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArgumentResolverConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserIdArgumentResolver</span> userIdArgumentResolver<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addArgumentResolvers</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HandlerMethodArgumentResolver</span><span class="token punctuation">&gt;</span></span> resolvers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        resolvers<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>userIdArgumentResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-测试"><a href="#_3-测试" class="header-anchor">#</a> 3. 测试</h3> <p>业务功能：用户在请求敏感接口时，我需要拿到他的token解析成功，才允许他访问</p> <p>在需要获取UserId的方法中增加对应的方法参数，然后使用**@CurrentUserId**进行标识即可获取到数据</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token comment">//@CrossOrigin</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserServcie</span> userServcie<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/findAll&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token annotation punctuation">@CurrentUserId</span> <span class="token class-name">String</span> userId<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//调用service查询数据 ，进行返回s</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> userServcie<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span>users<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_6-4-声明式事务"><a href="#_6-4-声明式事务" class="header-anchor">#</a> 6.4 声明式事务</h2> <h3 id="使用介绍"><a href="#使用介绍" class="header-anchor">#</a> 使用介绍</h3> <p>直接在需要事务控制<strong>的方法上</strong>加上对应的注解**@Transactional**即可。如ServiceImpl里边的事务的业务方法！在抛出RuntimeException或者Error时，才会触发事务的回滚了。</p> <p>**基于Spring AOP实现，方法就是在方法前后进行拦截。**这种事务的开启简单优雅，是Spring官方推荐的用法。</p> <h3 id="失效的场景"><a href="#失效的场景" class="header-anchor">#</a> 失效的场景</h3> <p>即使挂对了@Transactional标签，事务失效的场景依然是非常多的，场景如下</p> <ol><li>@Transactional 应用在非 public 修饰的方法上</li> <li>bean没有被Spring容器管理</li> <li>事务方法抛出非RuntimeException异常：<strong>只能在抛出RuntimeException或者Error时才会触发事务的回滚</strong>，如果方法往外抛出 checked exception，该方法虽然不会再执行后续操作，但仍会提交已执行的数据操作。这样可能使得只有部分数据提交，造成数据不一致</li> <li>同一个类中方法调用，导致@Transactional失效</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token annotation punctuation">@Transactional</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>异常被catch捕获导致@Transactional失效</li> <li>@Transactional 注解属性 propagation 设置错误</li> <li>@Transactional 注解属性 rollbackFor 设置错误</li></ul> <h2 id="_6-5-aop入门"><a href="#_6-5-aop入门" class="header-anchor">#</a> 6.5 AOP入门</h2> <blockquote><p>在方法执行前增强什么功能，执行后增强什么功能……</p> <p>AOP详细知识学习见：https://space.bilibili.com/663528522  中的Spring教程</p></blockquote> <p>在SpringBoot中默认是开启AOP功能的。如果不想开启AOP功能可以使用如下配置设置为false，如下：</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">aop</span><span class="token punctuation">:</span>
    <span class="token key atrule">auto</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</code></pre></div><h3 id="proceedingjoinpoint用法使用详解"><a href="#proceedingjoinpoint用法使用详解" class="header-anchor">#</a> ProceedingJoinPoint用法使用详解</h3> <ul><li><p><strong>JointPoint</strong>是程序运行过程中可识别的点，这个点可以用来作为<a href="https://so.csdn.net/so/search?q=AOP&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">AOP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>切入点。JointPoint对象则包含了和切入相关的很多信息。比如切入点的对象，方法，属性等。我们可以通过反射的方式获取这些点的状态和信息，用于追踪tracing和记录logging应用信息。</p></li> <li><p><strong>ProceedingJoinPoint继承了 JoinPoint</strong>。是在JoinPoint的基础上暴露出 proceed 这个方法。proceed很重要，这个是aop代理链执行的方法。</p></li></ul> <p>我们到底需要获取切入点的那些信息。我的思考如下</p> <ol><li>切入点的方法名字及其参数</li> <li>切入点方法标注的注解对象（通过该对象可以获取注解信息）</li> <li>切入点目标对象（可以通过反射获取对象的类名，属性和方法名）</li></ol> <blockquote><p>若切入点表达式是方法，则获得的是切入点方法的信息。</p> <p>若切入点表达式是注解，则获得的是使用了切入点注解的方法的信息，但SpringAOP仅支持在方法上使用自定义注解</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;pointCut()&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">around3</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token class-name">MethodSignature</span> methodSignature <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MethodSignature</span><span class="token punctuation">)</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Method</span> method <span class="token operator">=</span> methodSignature<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>获取参数</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;pointCut()&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">around3</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> objects <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> o <span class="token operator">:</span> objects<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token keyword">instanceof</span> <span class="token class-name">User</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;id是：&quot;</span>     <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                                <span class="token string">&quot;; 名字是：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                                <span class="token string">&quot;; 备注是：&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getNote</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>若切入点表达式是方法，则获得的是切入点方法所在类。若切入点表达式是注解，则获得的是使用此注解的方法所在的类。</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;pointCut()&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">around3</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;joinPoint.getTarget().toString() : &quot;</span> <span class="token operator">+</span> 
        joinPoint<span class="token punctuation">.</span><span class="token function">getTarget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_1-准备环境"><a href="#_1-准备环境" class="header-anchor">#</a> 1. 准备环境</h3> <p><strong>在aop包下：</strong></p> <p>①添加依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-aop<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>②自定义注解</p> <p>在annotation包下</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">InvokeLog</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

</code></pre></div><p>③定义切面类</p> <ul><li>在aspect包下创建该类；</li> <li>复制类的全限定名</li></ul> <img src="https://i0.hdslb.com/bfs/album/f5b8461bb02d8433896308cae841f6a9495f3df5.png" alt="image-20221023003426745" style="zoom:50%;"> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Aspect</span>  <span class="token comment">//标识这是一个切面类</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InvokeLogAspect</span> <span class="token punctuation">{</span>

    <span class="token comment">//确定切点：括号内的注解来定位，这个注解用在哪里，我就在那里切入</span>
    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;@annotation(com.sangeng.aop.InvokeLog)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//标识环绕通知，作用于哪个切点。</span>
    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;pt()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">printInvokeLog</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//目标方法调用前</span>
        <span class="token class-name">Object</span> proceed <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">MethodSignature</span> signature <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MethodSignature</span><span class="token punctuation">)</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> methodName <span class="token operator">=</span> signature<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>methodName<span class="token operator">+</span><span class="token string">&quot;即将被调用&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            proceed <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//目标方法调用后</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>methodName<span class="token operator">+</span><span class="token string">&quot;被调用完了&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            throwable<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//目标方法出现异常了</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>methodName<span class="token operator">+</span><span class="token string">&quot;出现了异常&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> proceed<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_2-使用测试"><a href="#_2-使用测试" class="header-anchor">#</a> 2. 使用测试</h3> <p>在需要正确的地方增加对应的注解 <strong>@InvokeLog</strong></p> <div class="language-Java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserServcie</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserMapper</span> userMapper<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token annotation punctuation">@InvokeLog</span>  <span class="token comment">//需要被增强方法需要加上对应的注解</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> userMapper<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-切换为jdk动态代理"><a href="#_3-切换为jdk动态代理" class="header-anchor">#</a> 3. 切换为jdk动态代理</h3> <p>有的时候我们需要修改AOP的代理方式。</p> <p>我们可以使用以下方式修改：</p> <p>在配置文件中配置spring.aop.proxy-target-class为false这为使用jdk动态代理。该配置默认值为true，代表使用cglib动态代理。</p> <p>主启动类：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableAspectJAutoProxy</span><span class="token punctuation">(</span>proxyTargetClass <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment">//修改代理方式</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ConfigurableApplicationContext</span> context <span class="token operator">=</span> <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">WebApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果想生效还需要在配置文件中做如下配置</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">aop</span><span class="token punctuation">:</span>
    <span class="token key atrule">proxy-target-class</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment">#切换动态代理的方式</span>
</code></pre></div><h2 id="_6-6-博客项使用aop"><a href="#_6-6-博客项使用aop" class="header-anchor">#</a> 6.6 博客项使用Aop</h2> <ol><li>导入依赖。</li> <li>创建自定义注解</li> <li>创建切面类</li> <li>使用aop注解</li></ol> <h3 id="自定义注解-在annotation包下"><a href="#自定义注解-在annotation包下" class="header-anchor">#</a> 自定义注解，在annotation包下</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ElementType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Retention</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RetentionPolicy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Target</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">AopLog</span> <span class="token punctuation">{</span>
    <span class="token comment">//在方法添加这个注解时，可以顺便写上注释在这个属性上</span>
    <span class="token class-name">String</span> <span class="token function">businessName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="切面-在aspect包下"><a href="#切面-在aspect包下" class="header-anchor">#</a> 切面，在aspect包下</h3> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span><span class="token class-name">JSON</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>cola<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">AopLog</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">ProceedingJoinPoint</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Around</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Aspect</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Pointcut</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>aspectj<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">MethodSignature</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>context<span class="token punctuation">.</span>request<span class="token punctuation">.</span></span><span class="token class-name">RequestContextHolder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>context<span class="token punctuation">.</span>request<span class="token punctuation">.</span></span><span class="token class-name">ServletRequestAttributes</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>


<span class="token comment">/**
 * @Author: cola99year
 * @Date: 2022/10/23 0:33
 */</span>
<span class="token annotation punctuation">@Aspect</span>  <span class="token comment">//标识这是一个切面类</span>
<span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogAspect</span> <span class="token punctuation">{</span>
    <span class="token comment">//确定切点：括号内的注解来定位，这个注解在哪使用，我就在那里切入</span>
    <span class="token annotation punctuation">@Pointcut</span><span class="token punctuation">(</span><span class="token string">&quot;@annotation(com.cola.annotation.AopLog)&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 环绕通知
     * @param joinPoint 目标方法的信息封装成的一个对象
     * @return
     * @throws Throwable  目标方法执行会出现的异常
     */</span>
    <span class="token annotation punctuation">@Around</span><span class="token punctuation">(</span><span class="token string">&quot;pt()&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">printLog</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//前置通知：执行我自定义的方法handleBefore</span>
            <span class="token function">handleBefore</span><span class="token punctuation">(</span>joinPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//让目标方法执行，并获取其返回的结果</span>
            result <span class="token operator">=</span> joinPoint<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//后置通知：执行我自定义的方法handleAfter</span>
            <span class="token function">handleAfter</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment">// 结束后换行，log方法来自lombok的slf4j</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;=======End=======&quot;</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">lineSeparator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//System.lineSeparator()换行的意思，为了适配Linux和Windows换行符不同的问题</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handleBefore</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//Spring提供的，内部使用了ThreadLocal，每个线程只会获取自己的变量对象，线程隔离</span>
        <span class="token comment">//需要注意返回的对象类型必须是ServletRequestAttributes，才有getRequest方法获取request对象</span>
        <span class="token class-name">ServletRequestAttributes</span> requestAttributes <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ServletRequestAttributes</span><span class="token punctuation">)</span> <span class="token class-name">RequestContextHolder</span><span class="token punctuation">.</span><span class="token function">getRequestAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取request对象</span>
        <span class="token class-name">HttpServletRequest</span> request <span class="token operator">=</span> requestAttributes<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取注解对象</span>
        <span class="token class-name">AopLog</span> aopLog <span class="token operator">=</span> <span class="token function">getAopLog</span><span class="token punctuation">(</span>joinPoint<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;=======Start=======&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印请求 URL</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;URL            : {}&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span><span class="token function">getRequestURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印描述信息,aop自定义注解里的那个属性</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;BusinessName   : {}&quot;</span><span class="token punctuation">,</span> aopLog<span class="token punctuation">.</span><span class="token function">businessName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印 Http method</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;HTTP Method    : {}&quot;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印调用controller的全路径以及执行方法:com.cola.controller.UserController.saveUserInfo</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Class Method   : {}.{}&quot;</span><span class="token punctuation">,</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaringTypeName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MethodSignature</span><span class="token punctuation">)</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印请求的 IP</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;IP             : {}&quot;</span><span class="token punctuation">,</span>request<span class="token punctuation">.</span><span class="token function">getRemoteHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 打印请求入参,注意参数类型很多，把他们转为String型</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Request Args   : {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>joinPoint<span class="token punctuation">.</span><span class="token function">getArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">handleAfter</span><span class="token punctuation">(</span><span class="token class-name">Object</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 打印出参</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Response       : {}&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取指定方法的aop注解对象
     * @param joinPoint 目标方法的信息封装成的一个对象
     * @return
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">AopLog</span> <span class="token function">getAopLog</span><span class="token punctuation">(</span><span class="token class-name">ProceedingJoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//获取方法的签名</span>
        <span class="token class-name">MethodSignature</span> methodSignature <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MethodSignature</span><span class="token punctuation">)</span>joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//获取方法的AopLog.class注解</span>
        <span class="token class-name">AopLog</span> aopLog <span class="token operator">=</span> methodSignature<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAnnotation</span><span class="token punctuation">(</span><span class="token class-name">AopLog</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> aopLog<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用注解"><a href="#使用注解" class="header-anchor">#</a> 使用注解</h3> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@PutMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/userInfo&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@AopLog</span><span class="token punctuation">(</span>businessName <span class="token operator">=</span> <span class="token string">&quot;更新个人信息&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseResult</span> <span class="token function">updateUserInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">updateUserInfo</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><h2 id="_6-7-日志"><a href="#_6-7-日志" class="header-anchor">#</a> 6.7 日志</h2> <p>开启日志</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">debug</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#开启日志</span>
<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com.sangeng</span><span class="token punctuation">:</span> debug <span class="token comment">#设置日志级别</span>
</code></pre></div><hr> <h1 id=""><a href="#" class="header-anchor">#</a></h1> <h1 id="狂神"><a href="#狂神" class="header-anchor">#</a> 狂神？</h1> <h2 id="jsr303数据校验-validated"><a href="#jsr303数据校验-validated" class="header-anchor">#</a> JSR303数据校验@validated</h2> <p><strong>作用：</strong></p> <p>Springboot中可以用**@validated<strong>来校验数据，如果数据异常则会</strong>统一抛出异常，方便异常中心统一处理**。</p> <blockquote><p>比如：我Person里的email属性，格式必须是邮件格式，否则提示这是一个不合法的格式！</p></blockquote> <h3 id="_5-1-数据校验例子"><a href="#_5-1-数据校验例子" class="header-anchor">#</a> 5.1 数据校验例子</h3> <p><strong>使用数据校验时，@Email报红：</strong></p> <p>原因：Springboot版本问题，亦或是新版IDEA的问题</p> <p>在pom.xml中加入依赖：</p> <div class="language-XML extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-validation<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>**Person ：**这里省略了setter、getter等……</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//实体类的注解，相当于controller层的注解，这spring的基础知识</span>
<span class="token annotation punctuation">@Component</span>

<span class="token comment">//我在yaml文件对这个Person类进行了赋值，这个注解绑定了yaml文件，获取到了yaml里的赋值</span>
<span class="token comment">//这个person01是new出的那个对象的名字</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;person01&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Validated</span><span class="token comment">//这是数据校验的注解</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Dog</span> dog<span class="token punctuation">;</span>
<span class="token comment">//    这是数据格式的参数，还有很多！</span>
    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;邮箱格式错误！&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
</code></pre></div><p>前缀是person01的，都会应用那个注解的功能！</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token comment">#这个person01是new出的那个对象的名字</span>
<span class="token key atrule">person01</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> cola
<span class="token comment">#  yaml文件还可以用El表达式，生成随即年龄</span>
  <span class="token key atrule">age</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>random.int<span class="token punctuation">}</span>
  <span class="token key atrule">Dog</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> 旺财
    <span class="token key atrule">age</span><span class="token punctuation">:</span> <span class="token number">3</span>
</code></pre></div><p>测试：后台报出了 “ Test failed：1个 ”</p> <p><img src="https://img-blog.csdnimg.cn/271163a57c1044a4ab9f5dad5466a04f.png" alt="img"></p> <hr> <p>报红：</p> <p><img src="https://img-blog.csdnimg.cn/b66871c5843148089a1735cad9104006.png" alt="img"></p> <hr> <h3 id="_5-2-数据校验大全"><a href="#_5-2-数据校验大全" class="header-anchor">#</a> 5.2 数据校验大全</h3> <p>点击包名的constraints，在External Libraries 就会出现</p> <img src="https://img-blog.csdnimg.cn/9b12eb7142764cd9ad46bb1f19825f2b.png" alt="img" style="zoom:80%;"> <div class="language-text extra-class"><pre class="language-text"><code>@NotNull(message=&quot;名字不能为空&quot;)
private String userName;
@Max(value=120,message=&quot;年龄最大不能查过120&quot;)
private int age;
@Email(message=&quot;邮箱格式错误&quot;)
private String email;

空检查
@Null       验证对象是否为null
@NotNull    验证对象是否不为null, 无法查检长度为0的字符串
@NotBlank   检查约束字符串是不是Null还有被Trim的长度是否大于0,只对字符串,且会去掉前后空格.
@NotEmpty   检查约束元素是否为NULL或者是EMPTY.
    
Booelan检查
@AssertTrue     验证 Boolean 对象是否为 true  
@AssertFalse    验证 Boolean 对象是否为 false  
    
长度检查
@Size(min=, max=) 验证对象（Array,Collection,Map,String）长度是否在给定的范围之内  
@Length(min=, max=) string is between min and max included.

日期检查
@Past       验证 Date 和 Calendar 对象是否在当前时间之前  
@Future     验证 Date 和 Calendar 对象是否在当前时间之后  
@Pattern    验证 String 对象是否符合正则表达式的规则

.......等等
除此以外，我们还可以自定义一些数据校验规则
</code></pre></div><h1 id="springboot自动配置原理"><a href="#springboot自动配置原理" class="header-anchor">#</a> Springboot自动配置原理</h1> <p>说来说去，就是<strong>内置的配置写在相关的类里</strong>了（还用<strong>prefix</strong>绑定了配置文件的<strong>前缀</strong>），有些配置类里默认生效一些功能，有些没有用到，也写在那。想生效就用那个**前缀.**可以在配置文件编写。</p> <blockquote><p>学得太浅了</p></blockquote> <ol><li>SpringBoot启动会<strong>加载大量的自动配置类</strong></li> <li>我们需要的功能有没有在SpringBoot默认写好的自动配置类当中；</li> <li>再来看这个自动配置类中到底配置了哪些组件；（<strong>只要我们要用的组件存在其中，我们就不需要再手动配置了</strong>）</li> <li>给容器中自动配置类添加组件的时候，会从properties类中获取某些属性。我们只需要在配置文件中指定这些属性的值即可；</li></ol> <p>**xxxxAutoConfigurartion：自动配置类；**给容器中添加组件</p> <p><strong>xxxxProperties:封装配置文件中相关属性；</strong></p> <p><img src="https://img-blog.csdnimg.cn/img_convert/be25b89948463807e964d488981285af.png" alt="img"></p> <p>参考文章：<a href="https://blog.csdn.net/weixin_38405253/article/details/119362472?ops_request_misc=%7B%22request%5Fid%22%3A%22164966455416780255291795%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=164966455416780255291795&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-4-119362472.142%5Ev7%5Earticle_score_rank,157%5Ev4%5Enew_style&amp;utm_term=xxxxAutoConfigurartion&amp;spm=1018.2226.3001.4187" target="_blank" rel="noopener noreferrer">(40条消息) SpringBoot场景启动器，你了解多少？_Java笔记虾的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h1 id="日期格式的支持"><a href="#日期格式的支持" class="header-anchor">#</a> 日期格式的支持？</h1> <p><img src="https://img-blog.csdnimg.cn/a539fe78fceb43668a12413be6d39dff.png" alt="img"></p> <h1 id="🥶swagger没学"><a href="#🥶swagger没学" class="header-anchor">#</a> 🥶swagger没学</h1></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/a42eba/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">测试</div></a> <a href="/pages/f4aca4/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">环境安装 - Linux下安装MySQL</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/a42eba/" class="prev">测试</a></span> <span class="next"><a href="/pages/f4aca4/">环境安装 - Linux下安装MySQL</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/a42eba/"><div>
            测试
            <!----></div></a> <span class="date">06-05</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/52d303/"><div>
            Java基础 - String类
            <!----></div></a> <span class="date">05-28</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/626fe7/"><div>
            Java基础 - 异常
            <!----></div></a> <span class="date">05-25</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> <!----></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div class="my-popup" style="display:none;" data-v-5f98aac3><div class="my-popup-container" data-v-5f98aac3><div class="my-popup-exit" data-v-5f98aac3></div> <img src="" alt data-v-5f98aac3></div></div></div></div>
    <script src="/assets/js/app.fb35259d.js" defer></script><script src="/assets/js/2.585c5b95.js" defer></script><script src="/assets/js/22.4f91168d.js" defer></script>
  </body>
</html>
